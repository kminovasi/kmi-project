import{E,a as u,h as v}from"./html2canvas.esm-0b8b4967.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const y=document.querySelector(".export-excel-exportTotalInnovatorByOrganization"),x=document.querySelector(".export-pdf-exportTotalInnovatorByOrganization");y&&y.addEventListener("click",async function(){const l=document.getElementById("totalInnovatorChart"),n=window.chartData,e=window.organizationUnitLabel;if(n&&l){const t=new E.Workbook,c=t.addWorksheet("Data"),s=new Set,r=Object.keys(n);r.forEach(m=>{Object.keys(n[m]).forEach(g=>{s.add(parseInt(g))})});const i=Array.from(s).sort(),d=[e,...i];c.addRow(d),r.forEach(m=>{const g=[m];i.forEach(b=>{g.push(n[m][b]||0)}),c.addRow(g)});const a=l.toDataURL("image/png"),o=t.addImage({base64:a.split(",")[1],extension:"png"});c.addImage(o,{tl:{col:0,row:r.length+2},ext:{width:500,height:300}});const h=await t.xlsx.writeBuffer(),p=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=window.URL.createObjectURL(p),w=document.createElement("a");w.href=f,w.download=`total_innovator_by_organization_${e}_${company_name}.xlsx`,w.click(),window.URL.revokeObjectURL(f)}}),x&&x.addEventListener("click",async function(){const l=document.getElementById("totalInnovatorChart"),n=window.chartData,e=window.organizationUnitLabel;if(n&&l){const t=new u;t.setFontSize(18),t.text("Total Innovator per "+e,10,10);const c=new Set,s=Object.keys(n);s.forEach(a=>{Object.keys(n[a]).forEach(o=>{c.add(parseInt(o))})});const r=Array.from(c).sort(),i=10,d=[i+t.getTextWidth(e)+10];r.forEach((a,o)=>{o>0&&d.push(d[o-1]+50)}),t.setFontSize(12),t.text(e,i,20),r.forEach((a,o)=>{t.text(a.toString(),d[o],20)}),s.forEach((a,o)=>{const h=30+o*10;t.text(a,i,h),r.forEach((p,f)=>{t.text((n[a][p]||0).toString(),d[f],h)})}),v(l).then(a=>{const o=a.toDataURL("image/png");t.addImage(o,"PNG",10,30+s.length*10,180,100),t.save(`total_innovator_by_organization_${e}_${company_name}.pdf`)})}})});
