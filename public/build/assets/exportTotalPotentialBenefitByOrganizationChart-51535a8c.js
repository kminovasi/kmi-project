import{E as u,a as x,h as k}from"./html2canvas.esm-0b8b4967.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const y=document.querySelector(".export-excel-totalPotentialBenefitByOrganizationChart"),b=document.querySelector(".export-pdf-totalPotentialBenefitByOrganizationChart");y&&y.addEventListener("click",async function(){const l=document.getElementById("totalPotentialChart"),a=window.chartData,n=window.organizationUnitLabel;if(a&&l){const t=new u.Workbook,r=t.addWorksheet("Data"),s=new Set,c=Object.keys(a);c.forEach(m=>{Object.keys(a[m]).forEach(g=>{s.add(parseInt(g))})});const i=Array.from(s).sort(),d=[n,...i];r.addRow(d),c.forEach(m=>{const g=[m];i.forEach(E=>{g.push(a[m][E]||0)}),r.addRow(g)});const o=l.toDataURL("image/png"),e=t.addImage({base64:o.split(",")[1],extension:"png"});r.addImage(e,{tl:{col:0,row:c.length+2},ext:{width:500,height:300}});const f=await t.xlsx.writeBuffer(),w=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),h=window.URL.createObjectURL(w),p=document.createElement("a");p.href=h,p.download=`total_potential_benefit_by_organization_${n}_${company_name}.xlsx`,p.click(),window.URL.revokeObjectURL(h)}}),b&&b.addEventListener("click",async function(){const l=document.getElementById("totalPotentialChart"),a=window.chartData,n=window.organizationUnitLabel;if(a&&l){const t=new x;t.setFontSize(18),t.text("Total Potensial Benefit Per "+n,10,10);const r=new Set,s=Object.keys(a);s.forEach(o=>{Object.keys(a[o]).forEach(e=>{r.add(parseInt(e))})});const c=Array.from(r).sort(),i=10,d=[i+t.getTextWidth(n)+10];c.forEach((o,e)=>{e>0&&d.push(d[e-1]+50)}),t.setFontSize(12),t.text(n,i,20),c.forEach((o,e)=>{t.text(o.toString(),d[e],20)}),s.forEach((o,e)=>{const f=30+e*10;t.text(o,i,f),c.forEach((w,h)=>{t.text((a[o][w]||0).toString(),d[h],f)})}),k(l).then(o=>{const e=o.toDataURL("image/png");t.addImage(e,"PNG",10,30+s.length*10,180,100),t.save(`total_potential_benefit_by_organization_${n}_${company_name}.pdf`)})}})});
