import{E,a as x,h as k}from"./html2canvas.esm-0b8b4967.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const y=document.querySelector(".export-excel"),b=document.querySelector(".export-pdf");y&&y.addEventListener("click",async function(){const h=document.getElementById("totalTeamChart"),a=window.chartData,c=window.organizationUnitLabel;if(a&&h){const t=new E.Workbook,s=t.addWorksheet("Data"),r=new Set,n=Object.keys(a);n.forEach(f=>{Object.keys(a[f]).forEach(w=>{r.add(parseInt(w))})});const i=Array.from(r).sort(),d=[c,...i];s.addRow(d),n.forEach(f=>{const w=[f];i.forEach(u=>{w.push(a[f][u]||0)}),s.addRow(w)});const o=h.toDataURL("image/png"),e=t.addImage({base64:o.split(",")[1],extension:"png"});s.addImage(e,{tl:{col:0,row:n.length+2},ext:{width:500,height:300}});const l=await t.xlsx.writeBuffer(),g=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=window.URL.createObjectURL(g),p=document.createElement("a");p.href=m,p.download=`total_team_by_organization_${c}_${company_name}.xlsx`,p.click(),window.URL.revokeObjectURL(m)}}),b&&b.addEventListener("click",async function(){const h=document.getElementById("totalTeamChart"),a=window.chartData,c=window.organizationUnitLabel;if(a&&h){const t=new x;t.setFontSize(18),t.text("Distribusi Ide dan Inovasi",10,10);const s=new Set,r=Object.keys(a);r.forEach(o=>{Object.keys(a[o]).forEach(e=>{s.add(parseInt(e))})});const n=Array.from(s).sort(),i=10,d=[i+t.getTextWidth(c)+10];n.forEach((o,e)=>{e>0&&d.push(d[e-1]+50)}),t.setFontSize(12),t.text(c,i,20),n.forEach((o,e)=>{t.text(o.toString(),d[e],20)}),r.forEach((o,e)=>{const l=30+e*10;t.text(o,i,l),n.forEach((g,m)=>{t.text((a[o][g]||0).toString(),d[m],l)})}),k(h).then(o=>{const e=o.toDataURL("image/png");t.addImage(e,"PNG",10,30+r.length*10,180,100),t.save(`total_team_by_organization_${c}_${company_name}.pdf`)})}})});
